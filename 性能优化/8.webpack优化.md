[toc]

webpack提供了两种模式，production模式和dev模式，这两种模式默认已经启动了一些性能优化的方式

![image-20221107131919403](../img/image-20221107131919403.png)

# tree-shaking(pro)

pro环境自动启用

一种性能优化的方法，在webpack入口有很多依赖的文件，但是有很多文件是没有用的文件或者只用到了这些依赖的一部分模块，tree shaking可以帮助我们删除没有用的部分

（1）DCE消除

+ 删除不能执行的代码
+ 删除代码结果没有被使用到的代码
+ 删除只会影响死变量的代码（let a=1,但是a没有被使用）

消除的原理：抽象语法树

（2）js里的DCE

需要在js到达浏览器之前，由uglify来完成，但是uglify无法跨文件执行

（3）tree shaking消除法

更关注于无用模块的消除，消除那些引用了但并没有被使用的模块

消除原理：依赖于ES6的模块特性，因为ES module，只能作为模块顶层的语句出现，而且import 的模块名只能是字符串常量，所以可以提前知道模块之间的依赖关系，然后做静态分析

+ 注意，它<font color="red">基于ES6的import export机制</font>

配置注意项

```json
//bable里必须开启module的机制，在bable.config.js里需要配置
//表示 ECMAScript模块不需要首先转换为CommonJS模块
{
  presets: [["es2015", { "modules": false }]]
}
```

