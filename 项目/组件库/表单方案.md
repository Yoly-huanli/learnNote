组件库方案

```VUE
 <auto-form
    ref="form"
    :schema="configs"
    :data="detail"
    @input="changeValue"
 />

<script>
/* eslint-disable */
import AutoForm from '../utils/index.vue'
export default {
  name: "HelloWorld",
  components: {
    AutoForm,
  },
  data() {
    const fruitMap = [
      {
        label: '苹果',
        value: 1
      },
      {
        label: '香蕉',
        value: 2
      }
    ]
    return {
      configs: [{
        fruitType: {
          label: '水果类型',
          type: 'radio',
          prop: 'accountType',
          defaultValue: 2,
          options: fruitMap,
          mapConfig: fruitMap,
       },
       fruitType2: {
          label: '水果类型',
          type: 'radio',
          prop: 'accountType',
          defaultValue: 2,
          options: fruitMap,
          mapConfig: fruitMap,
       },
     }],
      detail: {
        'fruitType': 1,
        'fruitType2': 2
      }
      
    };
  },
  methods: {
    changeValue(prop, value){
      console.log('prop--', prop, value)
    }

  },
  async created() {
  }
}
```

封装的autoform, 其实就是el-form的简单封装，然后根据schema映射到不同的组件

```vue
<template>
  <el-form
    ref="autoValidateForm"
    :model="initData"
    :validate-on-rule-change="false"
    :disabled="disabled"
  >
    <div
      v-for="(conf, index) in schema"
      :key="index"
      class="group"
    >
      <div>
        <el-row
          v-for="(row, rowIndex) in conf"
          :key="rowIndex"
        >
          <el-col
            :key="key"
            :span="row.span"
            class="col"
          >
            <form-base
              ref="baseValidateForm"
              :prop="row"
              :data="initData"
              :disabled="disabled"
              @input="valueChange"
              @blur="inputBlur"
            />
          </el-col>
        </el-row>
      </div>
    </div>
  </el-form>
</template>

<script>
/* eslint-disable */
import formBase from './Base'
import clone from 'clone'
import {get } from 'lodash'

export default {
  name: 'AutoForm',
  components: {
    formBase,
  },
  props: {
    // 传入的表单schema
    schema: {
      type: Array,
      default () {
        return []
      }
    },
    data: {
      type: Object,
      default () {
        return {}
      }
    },
    disabled: {
      type: Boolean,
      default: false
    },
    onChange: {
      type: Function,
      default: ()=>{}
    },
  },
  data () {
    return {
      initData: clone(this.data),
    }
  },
  watch: {
    data: {
      immediate: true,
      deep: true,
      handler: function (newValue) {
        this.initData = clone(newValue)
      }
    }
  },
  created () {
  },
  methods: {
    async validate () {
      this.$emit('validate')
      let autoValidateForm = get(this, '$refs.autoValidateForm.validate')
      let res = autoValidateForm && (await autoValidateForm())
      return res
    },
    autoValidateForm (prop) {
      this.$refs.autoValidateForm.validateField(prop)
    },
    resetFields () {
      this.$emit('resetFields')
      this.$refs.autoValidateForm.resetFields()
    },
    clearValidate () {
      this.$emit('clearValidate')
      this.$refs.autoValidateForm.clearValidate()
    },
    valueChange (value, prop) {
      this.$emit('input', clone(value), prop)
    },
    inputBlur (value, prop) {
      this.$emit('blur', clone(value), prop)
    },
  }
}
</script>
```

formItem

```vue
<script>
/* eslint-disable */
const componentseMap = {
  radio: 'auto-radio',
}
export default {
  name: 'AutoFormBase',
  components: {
  },
  props: {
    data: {
      type: [Object, Array],
      default() {
        return {}
      }
    },
    prop: {
      type: [Object, Array],
      default() {
        return {}
      }
    },
    parentKey: {
      type: String,
      default: ''
    },
    disabled: {
      type: Boolean,
      default: false
    }
  },
  methods: {
    valueChange(value) {
      this.data[this.prop.prop] = value
      this.$emit('input', {
        ...this.data,
      }, this.prop.prop)
    },
    inputBlur(value, prop) {
      this.data[this.prop.prop] = value
      this.$emit('blur', {
        ...this.data,
      }, this.prop.prop)
    },
    getBaseElem(createElement) {
      let components = componentseMap[this.prop.type] || ''
      return createElement(components, {
        props: {
          data: this.data,
          value: this.data[this.prop.prop],
          prop: this.prop,
          parentKey: this.prop.prop,
          disabled: this.disabled
        },
        on: {
          input: this.valueChange,
        }
      })
    },
    getLabelMessage (createElement) {
      if (!this.prop.label) return
      return createElement('span', { slot: 'label' }, [
        createElement('span', {}, this.prop.label),
      ])
    },
    getFormItem(createElement) {
      return createElement(
        'el-form-item',
        {
          key: this.prop.label,
          ref: 'baseFormItem',
          props: {
            prop: this.prop.prop,
            rules: this.prop.rules,
            key: this.prop.label,
            'label-width': this.prop.width ? this.prop.width : '',
            'show-message': this.prop.showMessage
          }
        },
        [
          this.getLabelMessage(createElement),
          this.getBaseElem(createElement),
        ]
      )
    },
  },
  render(createElement) {
    return createElement(
      'section',
      {
        class: {
          'group-item': true
        },
        attrs: {
          style: this.prop.style
        }
      },
      [this.getFormItem(createElement)]
    )
  }
}
</script>

```

radio组件

```
import Vue from 'vue'
import Radio from '../formComp/radio'
/* eslint-disable*/
Vue.use(Radio)
```

```vue
import Radio from './index.vue'
Radio.install = function (Vue) {
  Vue.component(Radio.name, Radio)
}
export default Radio
```

